<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#2d6a4f" />
    <meta name="description" content="DDP Supply Chain Landscape — interactive dependency intelligence mapping bottleneck pressure, supplier exposure, and evidence sourcing across defense supply chain layers." />
    <meta property="og:title" content="DDP Supply Chain Landscape" />
    <meta property="og:description" content="Interactive dependency intelligence mapping bottleneck pressure, supplier exposure, and evidence sourcing across defense supply chain layers." />
    <meta property="og:type" content="website" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' https://fonts.googleapis.com 'unsafe-inline'; font-src https://fonts.gstatic.com; img-src 'self' data:;" />
    <title>DDP Supply Chain Landscape</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect rx='18' width='100' height='100' fill='%233b6fb5'/><text x='50' y='72' font-size='60' text-anchor='middle' fill='white' font-family='system-ui'>G</text></svg>" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..700&family=Manrope:wght@500..800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
    <script>try{const t=localStorage.getItem('ddp.cy.theme');if(t)document.documentElement.dataset.theme=t;}catch(e){}</script>
    <script src="vendor/cytoscape-3.30.2.min.js"></script>
    <script src="vendor/dagre-0.8.5.min.js"></script>
    <script src="vendor/cytoscape-dagre-2.5.0.js"></script>
  </head>
  <body>
    <a href="#cy" class="skip-nav">Skip to graph</a>

    <!-- ── BTI Methodology overlay ── -->
    <div id="btiMethodOverlay" class="intro-overlay" style="display:none" role="dialog" aria-modal="true" aria-label="BTI Methodology">
      <div class="intro-card">
        <div class="intro-header">
          <img src="assets/logo.jpg" alt="" class="intro-logo" />
          <div>
            <h1 class="intro-title">Bottleneck Tightness Index</h1>
            <p class="intro-pub">Methodology &middot; v3</p>
          </div>
        </div>

        <p class="intro-lede">BTI is a <strong>0&ndash;100 composite score</strong> measuring how constrained a component is across supply, lead-time, substitutability, and regulatory dimensions. Higher scores indicate tighter bottlenecks.</p>

        <div class="intro-section">
          <div class="intro-subtitle">Four dimensions</div>
          <p>Each L3 component is scored <strong>1&ndash;5</strong> on four dimensions by reviewing supplier data, lead-time records, qualification requirements, and trade/export controls.</p>
          <table class="bti-rubric-table">
            <thead><tr><th>Dim</th><th>1 (low risk)</th><th>3 (moderate)</th><th>5 (critical)</th></tr></thead>
            <tbody>
              <tr><td><strong>SC</strong><br><small>Supply Concentration (30%)</small></td><td>5+ suppliers, multi-geo commodity</td><td>2&ndash;3 suppliers, some concentration</td><td>Sole source or adversary monopoly</td></tr>
              <tr><td><strong>LT</strong><br><small>Lead Time Stress (25%)</small></td><td>Stock, &lt;4 weeks</td><td>12&ndash;26 weeks</td><td>&gt;52 weeks, custom fab</td></tr>
              <tr><td><strong>SF</strong><br><small>Substitution Friction (25%)</small></td><td>Drop-in commodity</td><td>Board/firmware redesign</td><td>No alternative at spec</td></tr>
              <tr><td><strong>CE</strong><br><small>Compliance Exposure (20%)</small></td><td>EAR99, domestic</td><td>Moderate tariff / DFARS</td><td>ITAR / 10 USC 4872</td></tr>
            </tbody>
          </table>
        </div>

        <div class="intro-section">
          <div class="intro-subtitle">Scoring formula</div>
          <p>Ordinal scores (1&ndash;5) are mapped to a 0&ndash;100 scale, then weighted:</p>
          <div class="bti-formula-block">
            <div class="bti-formula">BTI = 0.30&times;SC + 0.25&times;LT + 0.25&times;SF + 0.20&times;CE</div>
            <small>Ordinal mapping: 1&rarr;10 &middot; 2&rarr;30 &middot; 3&rarr;50 &middot; 4&rarr;70 &middot; 5&rarr;90</small>
          </div>
        </div>

        <div class="intro-section">
          <div class="intro-subtitle">Hierarchy rollup</div>
          <p><strong>84 L3 components</strong> are scored individually from supplier-level research. L2 modules and L1 domains are computed as the <strong>average of their children's scores</strong> (28 L2 from L3, 7 L1 from L2).</p>
        </div>

        <div class="intro-section">
          <div class="intro-subtitle">Confidence &amp; limitations</div>
          <p>Each node carries a confidence tier (high / medium / low) reflecting evidence quality. Confidence is <strong>metadata only</strong>&mdash;it does not modify the BTI score. Scores reflect a point-in-time assessment (Feb 2025) based on public sources, trade data, and procurement records.</p>
        </div>

        <div class="intro-section">
          <div class="intro-subtitle">Version history</div>
          <p><strong>v1&ndash;v2</strong> derived BTI from proxy signals (capacity utilization, lead-time estimates, substitution heuristics) with confidence penalties. <strong>v3</strong> replaces proxies with <strong>direct ordinal assessment</strong> per dimension, scored from per-component research files with supplier-level justifications.</p>
        </div>

        <div class="intro-actions">
          <button id="btiMethodClose" class="intro-btn">Close</button>
        </div>
      </div>
    </div>

    <!-- ── Intro overlay (first visit) ── -->
    <div id="introOverlay" class="intro-overlay" role="dialog" aria-modal="true" aria-label="About this visualization">
      <div class="intro-card">
        <div class="intro-header">
          <img src="assets/logo.jpg" alt="" class="intro-logo" />
          <div>
            <h1 class="intro-title">Defense Industrial Base Constraint Map</h1>
            <p class="intro-pub">Eregion Research</p>
          </div>
        </div>

        <p class="intro-lede">An interactive map of the <strong>U.S. defense supply chain</strong>, showing which components face the tightest bottlenecks&mdash;and why.</p>

        <div class="intro-section">
          <div class="intro-subtitle">What you're looking at</div>
          <p>Each bubble is a component in the defense industrial base (engines, sensors, batteries, etc.). They're grouped into <strong>7 domains</strong> like Propulsion, Energy Storage, and Secure Comms.</p>
          <ul class="intro-legend">
            <li><span class="intro-sw intro-sw-big"></span> <strong>Bigger + redder</strong> = higher bottleneck pressure (supply-chain risk)</li>
            <li><span class="intro-sw intro-sw-small"></span> <strong>Smaller + muted</strong> = lower pressure, less constrained</li>
            <li><span class="intro-sw intro-sw-diamond"></span> <strong>Diamonds</strong> = supplier companies (toggle on with the switch)</li>
          </ul>
        </div>

        <div class="intro-section">
          <div class="intro-subtitle">How to explore</div>
          <ol class="intro-steps">
            <li><strong>Click a domain label</strong> (like "Propulsion") to expand it and see all its components</li>
            <li><strong>Click any node</strong> to see its risk profile, key blockers, and linked suppliers</li>
            <li><strong>Use the filters</strong> at the top to narrow by domain, confidence, or pressure level</li>
            <li><strong>Try "Top Bottlenecks"</strong> to instantly see the 10 most constrained components</li>
          </ol>
        </div>

        <div class="intro-actions">
          <button id="introClose" class="intro-btn">Start exploring</button>
          <label class="intro-dismiss-label">
            <input type="checkbox" id="introDontShow" checked /> Don't show again
          </label>
        </div>
      </div>
    </div>

    <div id="topPanel">
    <header class="top-header">
      <div class="brand-lockup">
        <a href="https://substack.com/@eregionresearch" target="_blank" rel="noopener noreferrer" class="brand-logo-link"><img src="assets/logo.jpg" alt="Eregion Research" class="brand-logo" /></a>
        <div class="brand-text">
          <div class="brand-title-row">
            <strong>Defense Industrial Base Constraint Map</strong>
            <span class="header-version">Live</span>
          </div>
          <span class="brand-subtitle">Supply-chain dependency intelligence &middot; bottleneck pressure &middot; supplier exposure</span>
        </div>
      </div>
      <div class="header-right">
        <div id="kpi" class="kpi">loading&hellip;</div>
        <button id="themeToggle" class="theme-toggle-btn" aria-label="Toggle light/dark mode" title="Toggle light/dark mode">
          <svg class="theme-icon theme-icon-sun" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <svg class="theme-icon theme-icon-moon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <span class="theme-toggle-label theme-label-light">Light</span>
          <span class="theme-toggle-label theme-label-dark">Dark</span>
        </button>
        <button id="btiMethodOpen" class="intro-reopen-btn" aria-label="BTI Methodology" title="BTI Methodology" style="font-size:10px;letter-spacing:.3px">BTI</button>
        <button id="introReopen" class="intro-reopen-btn" aria-label="About this map" title="About this map">?</button>
        <div class="brand-wordmark">Eregion Research</div>
      </div>
    </header>

    <section class="control-bar" role="toolbar" aria-label="Graph controls">
      <div class="control-cluster control-search">
        <label class="cluster-label" for="search">Search</label>
        <input id="search" placeholder="Node, id, or company" />
      </div>
      <div class="control-cluster">
        <label class="cluster-label" for="domainFilter">Domain</label>
        <select id="domainFilter">
          <option value="all">All</option>
          <option value="airframe_structures">Airframe</option>
          <option value="energy_storage">Energy</option>
          <option value="flight_control_guidance">Flight Ctrl</option>
          <option value="manufacturing_system">Manufacturing</option>
          <option value="pnt">PNT</option>
          <option value="propulsion">Propulsion</option>
          <option value="secure_comms">Secure Comms</option>
        </select>
      </div>
      <div class="control-cluster">
        <label class="cluster-label" for="confFilter">Confidence</label>
        <select id="confFilter">
          <option value="all">All</option>
          <option value="high">High</option>
          <option value="medium">Medium</option>
          <option value="low">Low</option>
        </select>
      </div>
      <div class="control-cluster">
        <label class="cluster-label" for="pressureFilter">Pressure</label>
        <select id="pressureFilter">
          <option value="all">All</option>
          <option value="high">High (&ge;70)</option>
          <option value="med">Medium (40&ndash;69)</option>
          <option value="low">Low (&lt;40)</option>
        </select>
      </div>
      <div class="control-cluster control-toggle">
        <label class="toggle-switch" for="companyToggle">
          <input type="checkbox" id="companyToggle" />
          <span class="toggle-slider"></span>
        </label>
        <span class="toggle-label" id="companyToggleLabel">Company overlay (0)</span>
      </div>
      <div class="control-cluster control-actions">
        <button id="expandAll">Expand All</button>
        <button id="showTop10">Top Bottlenecks</button>
        <button id="reset">Reset</button>
      </div>
    </section>

    </div>
    <div id="topPanelResizer" title="Drag to resize top panel"></div>

    <main>
      <div class="graph-wrap">
        <div id="cy" role="img" aria-label="Supply chain dependency graph">
          <div id="graphSpinner" class="graph-spinner" aria-label="Loading graph">
            <div class="spinner-ring"></div>
            <span>Loading graph&hellip;</span>
          </div>
        </div>
      </div>
      <div id="panelResizer" title="Drag to resize panel"></div>
      <aside id="panel" aria-label="Detail panel">
        <div class="card detail-card">
          <div class="card-header">Details</div>
          <div id="details"><small>Select a node to inspect risk profile, dependencies, and linked companies.</small></div>
          <div class="detail-subsection top-bottlenecks-wrap">
            <div class="detail-subtitle">Top Bottlenecks</div>
            <div id="topBottlenecksPanel"><small>Sorted by Bottleneck Pressure (0&ndash;100).</small></div>
          </div>
        </div>
        <div class="card legend-card">
          <details>
            <summary>Legend</summary>
            <div class="legend">
              <div class="legend-item"><span class="legend-swatch roundrect l1-swatch"></span> L1 anchor</div>
              <div class="legend-item"><span class="legend-swatch roundrect l2-swatch"></span> L2 component</div>
              <div class="legend-item"><span class="legend-swatch circle l3-swatch"></span> L3 component</div>
              <div class="legend-item"><span class="legend-swatch diamond company-swatch"></span> Company</div>
            </div>
            <div class="legend-section">Confidence (opacity)</div>
            <div class="legend">
              <div class="legend-item"><span class="legend-swatch circle conf-high"></span> High</div>
              <div class="legend-item"><span class="legend-swatch circle conf-med"></span> Med</div>
              <div class="legend-item"><span class="legend-swatch circle conf-low"></span> Low</div>
            </div>
            <div class="legend-section">Node size = Bottleneck Pressure (0&ndash;100)</div>
            <div class="legend-section">Node color = Bottleneck Pressure (same metric; darker = tighter)</div>
          </details>
        </div>
      </aside>
    </main>

    <button id="panelToggle" class="panel-toggle-btn" aria-label="Toggle detail panel" aria-expanded="false" aria-controls="panel">Details</button>

    <footer class="site-footer">
      <div class="footer-brand">
        <img src="assets/logo.jpg" alt="Eregion Research" class="footer-logo" />
        <span class="footer-name">Eregion Research</span>
      </div>
      <span class="footer-sep">&middot;</span>
      <a href="mailto:info@eregionlabs.com" class="footer-contact">info@eregionlabs.com</a>
      <span class="footer-sep">&middot;</span>
      <details class="footer-disclaimer">
        <summary>Disclaimer</summary>
        <div class="disclaimer-body">
          <p>This visualization is produced by Eregion Research for <strong>informational and analytical purposes only</strong>. It does not constitute investment, procurement, or policy advice.</p>
          <p>All data is derived from <strong>publicly available sources</strong>. Confidence levels vary across mappings&mdash;some relationships are well-documented while others are analytically inferred. Supply chains are dynamic; this represents a point-in-time assessment and may not reflect current conditions.</p>
          <p>Eregion Research is <strong>not affiliated with, endorsed by, or sponsored by</strong> the U.S. Department of Defense, any defense agency, or any company depicted. Company and program references are based on open-source reporting and do not imply any proprietary access or insider knowledge.</p>
          <p><strong>No warranty</strong> is made regarding the accuracy, completeness, or timeliness of the information presented. Use at your own discretion.</p>
        </div>
      </details>
    </footer>

    <script type="module" src="main.js"></script>
  </body>
</html>
